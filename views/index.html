<html>
  <head>
    <title>ì»¤í”¼ëŸ°</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <%- include('components/head.html') -%>
    <!-- Cutom CSS & JS -->
    <link rel="stylesheet" href="/assets/css/variables.css" />
    <link rel="stylesheet" href="/assets/css/main_tab.css" />
    <link rel="stylesheet" href="/assets/css/cart_modal.css" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <style>
      #wrap {
        min-height: calc(100vh - 250px);
      }
    </style>
  </head>
  <body>
    <%- include('components/header.html') -%>
    <div id="wrap">
      <!-- SECTION: VISUAL -->
      <section class="visual">
        <div class="video-area">
          <video id="video" muted autoplay loop>
            <source src="/assets/img/video/main_visual.mp4" type="video/mp4" />
          </video>
        </div>
        <div class="video-cover">
          <div class="text">
            <h2>ì»¤í”¼ëŸ°ì˜ ë›°ì–´ë‚œ ì›ë‘ë¡œ<br />ë‚˜ë§Œì˜ ì»¤í”¼ ì·¨í–¥ì„ ë°œê²¬í•´ë³´ì„¸ìš”</h2>
          </div>
        </div>
      </section>

      <!-- ì›ë‘ ì¶”ì²œ -->
      <section class="pick" id="pick">
        <div class="inner">
          <div class="side-nav">
            <div class="title">
              <h2>ì¶”ì²œ ì›ë‘ PICK!</h2>
              <a href="/items">
                <strong>ë”ë³´ê¸°</strong>
                <span class="material-icons">arrow_right_alt</span>
              </a>
            </div>
            <!-- ë§› ì„ íƒ -->
            <div class="tab-box">
              <label class="tab-label on">
                <input type="radio" name="taste" data-taste="ë‹¬ì½¤ ìŒ‰ì‹¸ë¦„" checked />
                <div class="tab tab--main">
                  <div class="material-icons">radio_button_unchecked</div>
                  <p>ë‹¬ì½¤ ìŒ‰ì‹¸ë¦„</p>
                </div>
              </label>
              <label class="tab-label">
                <input type="radio" name="taste" data-taste="ê³ ì†Œí•¨/êµ¬ìˆ˜í•¨" />
                <div class="tab tab--main">
                  <div class="material-icons">radio_button_unchecked</div>
                  <p>ê³ ì†Œí•¨, êµ¬ìˆ˜í•¨</p>
                </div>
              </label>
              <label class="tab-label">
                <input type="radio" name="taste" data-taste="ë¬µì§í•˜ê³  ë‹¬ì½¤í•œ ì—¬ìš´" />
                <div class="tab tab--main">
                  <div class="material-icons">radio_button_unchecked</div>
                  <p>ë¬µì§í•˜ê³  ë‹¬ì½¤í•œ ì—¬ìš´</p>
                </div>
              </label>
              <label class="tab-label">
                <input type="radio" name="taste" data-taste="ì€ì€í•˜ê³  í¸ì•ˆí•¨" />
                <div class="tab tab--main">
                  <div class="material-icons">radio_button_unchecked</div>
                  <p>ì€ì€í•˜ê³  í¸ì•ˆí•¨</p>
                </div>
              </label>
              <label class="tab-label">
                <input type="radio" name="taste" data-taste="ìƒí¼í•œ ì‚°ë¯¸ì™€ í–¥" />
                <div class="tab tab--main">
                  <div class="material-icons">radio_button_unchecked</div>
                  <p>ìƒí¼í•œ ì‚°ë¯¸ì™€ í–¥</p>
                </div>
              </label>
            </div>
          </div>

          <div class="item-box" id="pickItemBox"></div>
        </div>
      </section>

      <!-- ë¸”ë Œë“œ ì»¤í”¼ë§Œ ëª¨ì•˜ì–´ìš”! -->
      <section class="blend" id="blend">
        <div class="inner">
          <div class="title">
            <h2>ë¸”ë Œë“œ ì»¤í”¼ë§Œ ëª¨ì•˜ì–´ìš”!</h2>
            <a href="#">
              <strong>ë”ë³´ê¸°</strong>
              <span class="material-icons">arrow_right_alt</span>
            </a>
          </div>
          <div class="item-box" id="blendItemBox"></div>
        </div>
      </section>

      <!-- ë°°ë„ˆ -->
      <section class="banner">
        <div class="inner">
          <a href="/items">
            <h3>ì»¤í”¼ëŸ°ì—ì„œ ë‹¤ì–‘í•œ ì»¤í”¼ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”</h3>
            <div>
              <p>ì „ì²´ ìƒí’ˆ ë³´ê¸°</p>
              <span class="material-icons">arrow_right_alt</span>
            </div>
          </a>
        </div>
      </section>

      <!-- ORIGIN ë‚˜ë¼ë³„ì»¤í”¼ -->
      <section class="origins">
        <div class="inner">
          <div class="title">
            <h2>ë‚˜ë¼ë³„ í’ë¯¸ë¥¼ ëŠê»´ë³´ì„¸ìš”!</h2>
            <!-- <a href="#">
              <strong>ë”ë³´ê¸°</strong>
              <span class="material-icons">arrow_right_alt</span>
            </a> -->
          </div>
          <ul class="origin-ul">
            <li class="origin-list" id="africa-origin">
              <div class="origin-img-wrap">
                <div class="origin-img"></div>
                <div class="text-wrap">
                  <h3 class="origin">ì•„í”„ë¦¬ì¹´</h3>
                </div>
              </div>
              <ul class="origin-items"></ul>
            </li>
            <li class="origin-list" id="asia-origin">
              <div class="origin-img-wrap">
                <div class="origin-img"></div>
                <div class="text-wrap">
                  <h3 class="origin">ì•„ì‹œì•„/íƒœí‰ì–‘</h3>
                </div>
              </div>
              <ul class="origin-items"></ul>
            </li>
            <li class="origin-list" id="latin-america-origin">
              <div class="origin-img-wrap">
                <div class="origin-img"></div>
                <div class="text-wrap">
                  <h3 class="origin">ì¤‘ë‚¨ë¯¸</h3>
                </div>
              </div>
              <ul class="origin-items"></ul>
            </li>
          </ul>
        </div>
      </section>

      <!-- ì„ ë¬¼ì„¸íŠ¸ -->
      <section class="gift">
        <div class="swiper gift-swiper">
          <h2>ì†Œì¤‘í•œ ì‚¬ëŒì—ê²Œ ì„ ë¬¼í•˜ì„¸ìš”!</h2>
          <div class="swiper-wrapper" id="giftSwiperWrapper"></div>
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-prev">
          <span class="material-icons">arrow_back_ios</span>
        </div>
        <div class="swiper-next">
          <span class="material-icons">arrow_forward_ios</span>
        </div>
      </section>

      <!-- ì¥ë°”êµ¬ë‹ˆ ëª¨ë‹¬ -->
      <div class="modal cart-modal" id="cartModal">
        <div class="cart-modal-bg" id="cartBackground"></div>
        <div class="cart-modal-content">
          <div class="cart-content-wrap">
            <div class="cart-modal-text">
              <p class="cart-item-name"><!-- ìƒí’ˆëª… --></p>
              <div class="select-box option-select-box" id="optionSelectBox">
                <strong>ë¶„ì‡„ ì˜µì…˜</strong>
                <div class="option-select">
                  <select name="optionSnoInput" class="select-menu">
                    <option value="">= ë¶„ì‡„ ì˜µì…˜ ì„ íƒ =</option>
                    <option value="ë¶„ì‡„ ì•ˆí•¨(ì›ë‘ìƒíƒœ)">ë¶„ì‡„ ì•ˆí•¨(ì›ë‘ìƒíƒœ)</option>
                    <option value="ë“œë¦½ìš© ë¶„ì‡„(ì»¤í”¼ë©”ì´ì»¤ ê²¸ìš©)">ë“œë¦½ìš© ë¶„ì‡„(ì»¤í”¼ë©”ì´ì»¤ ê²¸ìš©)</option>
                    <option value="ëª¨ì¹´í¬íŠ¸ìš© ë¶„ì‡„">ëª¨ì¹´í¬íŠ¸ìš© ë¶„ì‡„</option>
                    <option value="ì—ìŠ¤í”„ë ˆì†Œë¨¸ì‹ ìš© ë¶„ì‡„">ì—ìŠ¤í”„ë ˆì†Œë¨¸ì‹ ìš© ë¶„ì‡„</option>
                    <option value="í”„ë Œì¹˜í”„ë ˆìŠ¤ìš© ë¶„ì‡„">í”„ë Œì¹˜í”„ë ˆìŠ¤ìš© ë¶„ì‡„</option>
                    <option value="ë”ì¹˜ìš© ë¶„ì‡„">ë”ì¹˜ìš© ë¶„ì‡„</option>
                  </select>
                </div>
              </div>
              <div class="select-box amount-select-box" id="amountSelectBox">
                <strong>ìˆ˜ëŸ‰ ì„ íƒ</strong>
                <div class="amount-select" id="amountSelect">
                  <button type="button" aria-label="ìˆ˜ëŸ‰ë‚´ë¦¬ê¸°" class="down-btn">-</button>
                  <span class="amount-count">1</span>
                  <button type="button" aria-label="ìˆ˜ëŸ‰ì˜¬ë¦¬ê¸°" class="up-btn">+</button>
                </div>
              </div>
            </div>
            <div class="cart-total-price">
              <strong>í•©ê³„</strong>
              <div><span class="total-price">0</span><span>ì›</span></div>
            </div>
            <div class="cart-modal-buttons">
              <button type="button" class="btn-cancel"><span>ì·¨ì†Œ</span></button>
              <button type="button" class="btn-confirm" id="btnCartConfirm"><span>í™•ì¸</span></button>
            </div>
          </div>
          <div class="cart-complete-content">
            <p class="cart-complete-text">ğŸ‘œ ìƒí’ˆì„ ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•˜ìŠµë‹ˆë‹¤.</p>
            <div class="cart-modal-buttons complete">
              <button type="button" class="btn-cancel"><span>ì‡¼í•‘ ê³„ì†í•˜ê¸°</span></button>
              <button type="button" class="btn-confirm" id="btnGoCart">
                <span>ì¥ë°”êµ¬ë‹ˆë¡œ ì´ë™</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- footer -->
    <%- include('components/footer.html') -%>
    <!-- top-btn -->
    <%- include('components/totop.html') -%>
    <script src="/assets/js/totop.js"></script>
    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/main.js"></script>
    <script>
      window.onload = async () => {
        try {
          const products = await getProducts();
          // ê° itemBoxì— ìƒí’ˆ ëª©ë¡ í‘œì‹œ
          displayProductList(products, 'pickItemBox', isCoffeeCategory);
          displayProductsByTaste(products, 'ë¸”ë Œë“œ', 'blendItemBox');
          displayOriginItems(products, 'ì•„í”„ë¦¬ì¹´', 'africa-origin');
          displayOriginItems(products, 'ì•„ì‹œì•„/íƒœí‰ì–‘', 'asia-origin');
          displayOriginItems(products, 'ì¤‘ë‚¨ë¯¸', 'latin-america-origin');
          displayGiftProducts(products);

          // íƒ­ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
          const tabLabels = document.querySelectorAll('.tab-label');
          const defaultTab = document.querySelector('.tab-label.on input');
          const defaultTaste = defaultTab.getAttribute('data-taste');
          let isTabClicked = false;

          tabLabels.forEach((label) => {
            const input = label.querySelector('input');
            const taste = input.getAttribute('data-taste');

            // ìƒí’ˆ í‘œì‹œ ì¡°ê±´ ë³€ê²½
            label.addEventListener('click', (event) => {
              const itemBoxId = taste === 'ë¸”ë Œë“œ' ? 'blendItemBox' : 'pickItemBox';

              // í•´ë‹¹ ë§›ì— í•´ë‹¹í•˜ëŠ” ìƒí’ˆì„ í•´ë‹¹ ë°•ìŠ¤ì— í‘œì‹œ
              displayProductsByTaste(products, taste, itemBoxId);

              event.preventDefault();

              // ëª¨ë“  íƒ­ì—ì„œ "on" í´ë˜ìŠ¤ ì œê±°
              tabLabels.forEach((tabLabel) => {
                tabLabel.classList.remove('on');
              });
              // í´ë¦­í•œ íƒ­ì— "on" í´ë˜ìŠ¤ ì¶”ê°€
              label.classList.add('on');

              isTabClicked = true; // íƒ­ì˜ í´ë¦­ì—¬ë¶€ í™•ì¸
            });

            // inputì˜ ë³€ê²½ ì´ë²¤íŠ¸ ì²˜ë¦¬
            input.addEventListener('change', () => {
              updateTabState(label, input);
            });

            // ì´ˆê¸° íƒ­ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateTabState(label, input);
          });

          // ì•„ë¬´ íƒ­ë„ í´ë¦­ë˜ì§€ ì•Šì€ ê²½ìš°, ê¸°ë³¸ íƒ­ì— í•´ë‹¹í•˜ëŠ” ë§›ì˜ ìƒí’ˆì„ í‘œì‹œ
          if (!isTabClicked) {
            const itemBoxId = defaultTaste === 'ë¸”ë Œë“œ' ? 'blendItemBox' : 'pickItemBox';
            displayProductsByTaste(products, defaultTaste, itemBoxId);
          }

          // í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬(ì¥ë°”êµ¬ë‹ˆ ë„£ê¸°, ì¥ë°”êµ¬ë‹ˆ ì´ë™)
          const confirmBtns = document.querySelectorAll('.btn-confirm');
          confirmBtns.forEach((confirmBtn) => {
            confirmBtn.addEventListener('click', () => {
              handleConfirmBtnClick(confirmBtn);
            });
          });

          // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬(ì¥ë°”êµ¬ë‹ˆ ëª¨ë‹¬ ë‹«ê¸°, ì‡¼í•‘ ê³„ì†)
          const cancelBtns = document.querySelectorAll('.btn-cancel');
          cancelBtns.forEach((btn) => {
            btn.addEventListener('click', () => {
              handleCancelBtnClick(btn);
            });
          });

          // ë°°ê²½ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬(ì¥ë°”êµ¬ë‹ˆ ëª¨ë‹¬ ë‹«ê¸°)
          const cartBackground = document.getElementById('cartBackground');
          cartBackground.addEventListener('click', () => {
            handleCartBackgroundClick();
          });

          // Gift Swiper ì´ˆê¸° ì…‹íŒ…
          new Swiper('.gift-swiper', {
            slidesPerView: 3,
            spaceBetween: 10,
            centeredSlides: 1,
            loop: true,
            autoplay: {
              delay: 5000,
            },
            pagination: {
              el: '.gift .swiper-pagination',
              clickable: true,
            },
            navigation: {
              prevEl: '.gift .swiper-prev',
              nextEl: '.gift .swiper-next',
            },
          });
        } catch (error) {
          console.error('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', error);
        }
      };
    </script>
  </body>
</html>
